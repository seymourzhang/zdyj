<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SBGrowingStdMapper">
    <cache type="org.mybatis.caches.ehcache.LoggingEhcache"/>
    <select id="selectByVarietyId" parameterType="pd" resultType="pd">
        select
            les.variety_id,
            les.variety,
            les.grow_week_age,
            les.lay_egg_week_age,
            truncate(ifnull(les.female_week_avg_weed_out, 0), 2)          AS female_week_avg_weed_out,
            truncate(ifnull(les.female_week_total_weed_out, 0), 1)        AS female_week_total_weed_out,
            truncate(ifnull(les.female_life, 0), 1)                       AS female_life,
            truncate(ifnull(les.male_weight, 0), 0)                       AS male_weight,
            truncate(ifnull(les.female_weight, 0), 0)                     AS female_weight,
            truncate(ifnull(les.cl_laying_rate, 0), 1)                    AS cl_laying_rate,
            truncate(ifnull(les.rs_laying_rate, 0), 1)                    AS rs_laying_rate,
            truncate(ifnull(les.rs_female_laying_avg_count, 0), 1)        AS rs_female_laying_avg_count,
            truncate(ifnull(les.rs_female_laying_total_count, 0), 1)      AS rs_female_laying_total_count,
            truncate(ifnull(les.qualified_egg_rate, 0), 1)                AS qualified_egg_rate,
            truncate(ifnull(les.rs_female_avg_qualified_count, 0), 1)     AS rs_female_avg_qualified_count,
            truncate(ifnull(les.rs_female_total_qualified_count, 0), 1)   AS rs_female_total_qualified_count,
            truncate(ifnull(les.chick_hatching_rate, 0), 1)               AS chick_hatching_rate,
            truncate(ifnull(les.breeding_chick_hatching, 0), 1)           AS breeding_chick_hatching,
            truncate(ifnull(les.breeding_chick_avg_count, 0), 1)          AS breeding_chick_avg_count,
            truncate(ifnull(les.breeding_chick_total_count, 0), 1)        AS breeding_chick_total_count
        from s_b_lay_egg_std les
        where 1=1
        <if test="variety_id != null">
          and les.variety_id = #{variety_id}
        </if>
        <if test="variety_id == null">
          and les.variety_id = 1
        </if>
    </select>

    <select id="selectBroilByVarietyId" parameterType="pd" resultType="pd">
        select
        gs.variety_id,
        gs.variety,
        gs.grow_week_age,
        truncate(ifnull(gs.female_week_avg_weed_out, 0), 2)      AS female_week_avg_weed_out,
        truncate(ifnull(gs.female_week_total_weed_out, 0), 1)    AS female_week_total_weed_out,
        truncate(ifnull(gs.female_life, 0), 1)                   AS female_life,
        truncate(ifnull(gs.male_weight, 0), 0)                   AS male_weight,
        truncate(ifnull(gs.female_weight, 0), 0)                 AS female_weight,
        truncate(ifnull(gs.avg_feed_daliy, 0), 1)                AS avg_feed_daliy,
        truncate(ifnull(gs.total_feed, 0), 1)                    AS total_feed,
        truncate(ifnull(gs.evenness, 0), 1)                      AS evenness,
        truncate(ifnull(gs.female_max_std_weight, 0), 1)         AS female_max_std_weight,
        truncate(ifnull(gs.female_min_std_weight, 0), 1)         AS female_min_std_weight
        from s_b_growing_std gs 
        where 1=1
        <if test="variety_id != null">
            and gs.variety_id = #{variety_id}
        </if>
        <if test="variety_id == null">
            and gs.variety_id = 1
        </if>
    </select>
</mapper>